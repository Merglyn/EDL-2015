Version 4
SHEET 1 1120 1572
WIRE -2992 -1232 -3152 -1232
WIRE -2752 -1232 -2928 -1232
WIRE -2528 -1232 -2608 -1232
WIRE -2400 -1232 -2464 -1232
WIRE -2272 -1232 -2400 -1232
WIRE -2128 -1232 -2272 -1232
WIRE -2096 -1232 -2128 -1232
WIRE -992 -1200 -1360 -1200
WIRE -2400 -1184 -2400 -1232
WIRE -2272 -1184 -2272 -1232
WIRE -896 -1168 -1328 -1168
WIRE -1984 -1152 -2000 -1152
WIRE -1968 -1152 -1984 -1152
WIRE -1968 -1136 -1968 -1152
WIRE -1328 -1136 -1328 -1168
WIRE -1280 -1136 -1328 -1136
WIRE -2992 -1120 -3024 -1120
WIRE -2864 -1120 -2912 -1120
WIRE -2752 -1120 -2752 -1232
WIRE -2752 -1120 -2784 -1120
WIRE -2000 -1120 -2048 -1120
WIRE -1856 -1104 -1936 -1104
WIRE -1616 -1104 -1856 -1104
WIRE -1360 -1104 -1360 -1200
WIRE -1280 -1104 -1360 -1104
WIRE -2128 -1088 -2128 -1232
WIRE -2000 -1088 -2128 -1088
WIRE -1456 -1072 -1488 -1072
WIRE -1344 -1072 -1456 -1072
WIRE -2400 -1056 -2400 -1104
WIRE -2336 -1056 -2400 -1056
WIRE -2272 -1056 -2272 -1120
WIRE -2272 -1056 -2336 -1056
WIRE -288 -1056 -656 -1056
WIRE -272 -1056 -288 -1056
WIRE -240 -1056 -272 -1056
WIRE 112 -1056 -240 -1056
WIRE -2800 -1040 -2848 -1040
WIRE -2656 -1040 -2800 -1040
WIRE -1344 -1040 -1344 -1072
WIRE -1280 -1040 -1344 -1040
WIRE -3360 -1024 -3456 -1024
WIRE -3152 -1024 -3152 -1232
WIRE -3152 -1024 -3280 -1024
WIRE -3104 -1024 -3152 -1024
WIRE -3024 -1024 -3024 -1120
WIRE -3024 -1024 -3040 -1024
WIRE -2960 -1024 -3024 -1024
WIRE -2336 -1024 -2336 -1056
WIRE -2048 -1024 -2048 -1120
WIRE -1968 -1024 -2048 -1024
WIRE -1904 -1024 -1968 -1024
WIRE -2848 -1008 -2848 -1040
WIRE -2048 -1008 -2048 -1024
WIRE -1760 -1008 -1776 -1008
WIRE -1744 -1008 -1760 -1008
WIRE -1616 -1008 -1616 -1104
WIRE -1280 -1008 -1616 -1008
WIRE -2960 -992 -2960 -1024
WIRE -2880 -992 -2960 -992
WIRE -1968 -992 -1968 -1024
WIRE -1904 -992 -1904 -1024
WIRE -1888 -992 -1904 -992
WIRE -1760 -992 -1760 -1008
WIRE -1760 -992 -1808 -992
WIRE -2752 -976 -2752 -1120
WIRE -2752 -976 -2816 -976
WIRE -2608 -976 -2608 -1232
WIRE -2608 -976 -2752 -976
WIRE -2560 -976 -2608 -976
WIRE -1280 -976 -1360 -976
WIRE 112 -976 112 -1056
WIRE -2880 -960 -2960 -960
WIRE -1072 -960 -1184 -960
WIRE -1040 -960 -1072 -960
WIRE -656 -960 -656 -1056
WIRE -96 -960 -176 -960
WIRE 0 -960 -16 -960
WIRE 16 -960 0 -960
WIRE 480 -960 368 -960
WIRE -3152 -944 -3152 -1024
WIRE -1280 -944 -1328 -944
WIRE -1104 -928 -1184 -928
WIRE -464 -928 -528 -928
WIRE -272 -928 -272 -1056
WIRE -272 -928 -320 -928
WIRE 16 -928 16 -960
WIRE 48 -928 16 -928
WIRE 304 -928 176 -928
WIRE 368 -928 368 -960
WIRE 368 -928 304 -928
WIRE 672 -928 592 -928
WIRE -1280 -912 -1376 -912
WIRE -2048 -896 -2048 -928
WIRE -1968 -896 -1968 -928
WIRE -1968 -896 -2048 -896
WIRE -1104 -896 -1104 -928
WIRE -1104 -896 -1184 -896
WIRE -464 -896 -496 -896
WIRE -256 -896 -320 -896
WIRE -2960 -880 -2960 -960
WIRE -2880 -880 -2960 -880
WIRE -2656 -880 -2656 -1040
WIRE -2656 -880 -2800 -880
WIRE -1280 -880 -1344 -880
WIRE 48 -880 16 -880
WIRE 304 -880 176 -880
WIRE 368 -880 304 -880
WIRE -2048 -864 -2048 -896
WIRE -1104 -864 -1104 -896
WIRE -464 -864 -576 -864
WIRE -176 -864 -176 -960
WIRE -176 -864 -320 -864
WIRE 368 -864 368 -880
WIRE 480 -864 368 -864
WIRE 704 -864 592 -864
WIRE -2960 -848 -2960 -880
WIRE -1280 -848 -1408 -848
WIRE -96 -848 -128 -848
WIRE 0 -848 -16 -848
WIRE 16 -848 16 -880
WIRE 16 -848 0 -848
WIRE -1152 -832 -1184 -832
WIRE -464 -832 -608 -832
WIRE -272 -832 -320 -832
WIRE -1280 -816 -1392 -816
WIRE -272 -800 -272 -832
WIRE 112 -784 112 -832
WIRE -1152 -768 -1152 -832
WIRE -1072 -768 -1152 -768
WIRE -1056 -768 -1072 -768
WIRE -576 -752 -576 -864
WIRE -464 -688 -512 -688
WIRE -240 -688 -240 -1056
WIRE -240 -688 -320 -688
WIRE -1504 -672 -1520 -672
WIRE -1408 -672 -1408 -848
WIRE -1408 -672 -1504 -672
WIRE -1328 -672 -1328 -944
WIRE -1216 -672 -1328 -672
WIRE -1200 -672 -1216 -672
WIRE -464 -656 -496 -656
WIRE -256 -656 -320 -656
WIRE -1504 -624 -1520 -624
WIRE -1392 -624 -1392 -816
WIRE -1392 -624 -1504 -624
WIRE -1360 -624 -1360 -976
WIRE -1216 -624 -1360 -624
WIRE -1200 -624 -1216 -624
WIRE -576 -624 -576 -752
WIRE -464 -624 -576 -624
WIRE -128 -624 -128 -848
WIRE -128 -624 -320 -624
WIRE -464 -592 -560 -592
WIRE -272 -592 -320 -592
WIRE -2656 -560 -3264 -560
WIRE -272 -544 -272 -592
WIRE -2144 -496 -2144 -512
WIRE -2144 -496 -2224 -496
WIRE -1856 -496 -1904 -496
WIRE -2368 -480 -2416 -480
WIRE -2272 -480 -2368 -480
WIRE -3104 -448 -3152 -448
WIRE -2848 -448 -2880 -448
WIRE -2832 -448 -2848 -448
WIRE -3152 -432 -3152 -448
WIRE -2656 -416 -2656 -560
WIRE -1376 -400 -1376 -912
WIRE -608 -400 -608 -832
WIRE -608 -400 -1376 -400
WIRE -560 -400 -560 -592
WIRE -560 -400 -608 -400
WIRE -288 -400 -560 -400
WIRE -16 -400 -288 -400
WIRE -3104 -384 -3216 -384
WIRE 352 -368 112 -368
WIRE 704 -368 704 -864
WIRE 704 -368 352 -368
WIRE -2224 -352 -2224 -400
WIRE -1968 -352 -2224 -352
WIRE -1936 -352 -1968 -352
WIRE -1840 -352 -1936 -352
WIRE -1760 -352 -1776 -352
WIRE -16 -336 -48 -336
WIRE 176 -336 112 -336
WIRE 208 -336 176 -336
WIRE -3264 -320 -3264 -560
WIRE -3264 -320 -3360 -320
WIRE -3104 -320 -3264 -320
WIRE -2768 -320 -2880 -320
WIRE -2736 -320 -2768 -320
WIRE -2736 -304 -2736 -320
WIRE -2656 -304 -2656 -336
WIRE -2656 -304 -2736 -304
WIRE -2048 -304 -2064 -304
WIRE -1936 -304 -1936 -352
WIRE -1936 -304 -1968 -304
WIRE -2656 -288 -2656 -304
WIRE -1856 -272 -1856 -496
WIRE -3104 -256 -3568 -256
WIRE -2832 -256 -2880 -256
WIRE -1936 -256 -1936 -304
WIRE -1888 -256 -1936 -256
WIRE -992 -256 -992 -1200
WIRE 352 -256 352 -368
WIRE 352 -256 -992 -256
WIRE -1760 -240 -1760 -352
WIRE -1760 -240 -1824 -240
WIRE -1712 -240 -1760 -240
WIRE -3568 -224 -3568 -256
WIRE -1888 -224 -2080 -224
WIRE -2656 -192 -2656 -224
WIRE -3216 -160 -3216 -384
WIRE -2768 -160 -2768 -320
WIRE -2768 -160 -3216 -160
WIRE -1856 -160 -1856 -208
WIRE -1344 -144 -1344 -880
WIRE -768 -144 -1344 -144
WIRE -304 -80 -672 -80
WIRE -288 -80 -304 -80
WIRE -256 -80 -288 -80
WIRE 96 -80 -256 -80
WIRE 96 0 96 -80
WIRE -672 16 -672 -80
WIRE -112 16 -192 16
WIRE -16 16 -32 16
WIRE 0 16 -16 16
WIRE 464 16 352 16
WIRE -2560 48 -2656 48
WIRE -2480 48 -2560 48
WIRE -2448 48 -2480 48
WIRE -2368 48 -2448 48
WIRE -2192 48 -2368 48
WIRE -1968 48 -2192 48
WIRE -1664 48 -1968 48
WIRE -1536 48 -1664 48
WIRE -1392 48 -1536 48
WIRE -1296 48 -1392 48
WIRE -480 48 -544 48
WIRE -288 48 -288 -80
WIRE -288 48 -336 48
WIRE 0 48 0 16
WIRE 32 48 0 48
WIRE 288 48 160 48
WIRE 352 48 352 16
WIRE 352 48 288 48
WIRE 656 48 576 48
WIRE -480 80 -512 80
WIRE -272 80 -336 80
WIRE 32 96 0 96
WIRE 288 96 160 96
WIRE 352 96 288 96
WIRE -768 112 -768 -144
WIRE -592 112 -768 112
WIRE -480 112 -592 112
WIRE -192 112 -192 16
WIRE -192 112 -336 112
WIRE 352 112 352 96
WIRE 464 112 352 112
WIRE 688 112 576 112
WIRE -2656 128 -2656 48
WIRE -2560 128 -2560 48
WIRE -2480 128 -2480 48
WIRE -112 128 -144 128
WIRE -16 128 -32 128
WIRE 0 128 0 96
WIRE 0 128 -16 128
WIRE -3600 144 -3600 112
WIRE -3552 144 -3552 112
WIRE -3552 144 -3600 144
WIRE -3440 144 -3440 112
WIRE -3392 144 -3392 112
WIRE -3392 144 -3440 144
WIRE -480 144 -624 144
WIRE -288 144 -336 144
WIRE -3600 176 -3600 144
WIRE -3440 176 -3440 144
WIRE -3296 176 -3296 112
WIRE -3072 176 -3072 112
WIRE -2928 176 -2928 112
WIRE -288 176 -288 144
WIRE 96 192 96 144
WIRE -2192 224 -2192 48
WIRE -1968 224 -1968 48
WIRE -592 224 -592 112
WIRE -2368 240 -2368 48
WIRE -2656 256 -2656 192
WIRE -2560 256 -2560 192
WIRE -2480 256 -2480 192
WIRE -1536 272 -1536 48
WIRE -480 288 -528 288
WIRE -256 288 -256 -80
WIRE -256 288 -336 288
WIRE -480 320 -512 320
WIRE -272 320 -336 320
WIRE -592 352 -592 224
WIRE -480 352 -592 352
WIRE -144 352 -144 128
WIRE -144 352 -336 352
WIRE -2192 384 -2192 304
WIRE -1968 384 -1968 288
WIRE -1968 384 -2192 384
WIRE -480 384 -576 384
WIRE -288 384 -336 384
WIRE -3440 400 -3536 400
WIRE -3200 400 -3440 400
WIRE -2928 400 -3200 400
WIRE -1392 416 -1392 48
WIRE -3200 432 -3200 400
WIRE -2928 432 -2928 400
WIRE -288 432 -288 384
WIRE -3264 480 -3296 480
WIRE -2832 480 -2864 480
WIRE -1952 512 -2112 512
WIRE -1664 512 -1664 48
WIRE -1664 512 -1728 512
WIRE -2112 528 -2112 512
WIRE -2832 560 -2832 480
WIRE -1296 560 -1296 48
WIRE -3296 576 -3296 480
WIRE -2368 576 -2368 320
WIRE -2368 576 -2448 576
WIRE -2336 576 -2368 576
WIRE -2192 576 -2192 384
WIRE -2192 576 -2272 576
WIRE -2112 576 -2192 576
WIRE -1952 576 -2112 576
WIRE -1536 576 -1536 352
WIRE -1536 576 -1728 576
WIRE -1392 576 -1392 496
WIRE -1328 576 -1392 576
WIRE -624 576 -624 144
WIRE -576 576 -576 384
WIRE -576 576 -624 576
WIRE -304 576 -576 576
WIRE -32 576 -304 576
WIRE -3200 592 -3200 528
WIRE -3136 592 -3200 592
WIRE -2928 592 -2928 528
WIRE -2928 592 -2992 592
WIRE -1120 592 -1264 592
WIRE -1328 608 -1456 608
WIRE 352 608 96 608
WIRE 688 608 688 112
WIRE 688 608 352 608
WIRE -3440 624 -3440 400
WIRE -3200 624 -3200 592
WIRE -2928 624 -2928 592
WIRE -1952 640 -2176 640
WIRE -1536 640 -1536 576
WIRE -1536 640 -1728 640
WIRE -32 640 -64 640
WIRE 160 640 96 640
WIRE 192 640 160 640
WIRE -1392 656 -1392 576
WIRE -3296 672 -3296 576
WIRE -3264 672 -3296 672
WIRE -2832 672 -2832 560
WIRE -2832 672 -2864 672
WIRE -1536 672 -1536 640
WIRE -1296 688 -1296 624
WIRE -1952 704 -2048 704
WIRE -1664 704 -1728 704
WIRE -896 704 -896 -1168
WIRE 352 704 352 608
WIRE 352 704 -896 704
WIRE -1664 736 -1664 704
WIRE -3440 752 -3440 688
WIRE -3440 752 -3536 752
WIRE -3200 752 -3200 720
WIRE -3200 752 -3440 752
WIRE -2928 752 -2928 720
WIRE -2928 752 -3200 752
WIRE -1536 800 -1536 736
WIRE -1392 800 -1392 736
WIRE -2176 864 -2176 640
WIRE -1456 864 -1456 608
WIRE -1456 864 -2176 864
WIRE -1664 912 -1664 800
WIRE -576 1008 -640 1008
WIRE -480 1008 -496 1008
WIRE -368 1008 -400 1008
WIRE -320 1008 -368 1008
WIRE -48 1008 -176 1008
WIRE 32 1008 -48 1008
WIRE 96 1008 32 1008
WIRE 304 1008 96 1008
WIRE 432 1008 304 1008
WIRE -320 1040 -320 1008
WIRE -176 1040 -176 1008
WIRE 304 1040 304 1008
WIRE -48 1056 -48 1008
WIRE 96 1056 96 1008
WIRE -320 1168 -320 1120
WIRE -320 1168 -640 1168
WIRE -176 1168 -176 1120
WIRE -48 1168 -48 1120
WIRE -48 1168 -176 1168
WIRE -16 1168 -48 1168
WIRE 96 1168 96 1136
WIRE 96 1168 -16 1168
WIRE 304 1168 304 1120
WIRE 304 1168 96 1168
WIRE -16 1200 -16 1168
WIRE -64 1328 -176 1328
WIRE 80 1328 -64 1328
WIRE 160 1328 144 1328
WIRE 352 1328 224 1328
WIRE 512 1328 432 1328
WIRE 224 1344 224 1328
WIRE -176 1424 -176 1408
WIRE -64 1424 -64 1392
WIRE 224 1456 224 1424
FLAG 672 -928 w
FLAG -3072 256 0
FLAG -48 -336 trig
FLAG -288 -400 RVs
FLAG 304 -880 RDC2
FLAG 304 -928 RDC1
FLAG 112 -784 0
FLAG 0 -960 RB1
FLAG 0 -848 RB2
FLAG -288 -1056 10Vin
FLAG -656 -896 0
FLAG -496 -896 RCW
FLAG 176 -336 VCC
FLAG -528 -928 VCC
FLAG -272 -800 0
FLAG -272 -544 0
FLAG -512 -688 VCC
FLAG -496 -656 RCC
FLAG -3600 256 0
FLAG -3440 256 0
FLAG -3296 256 0
FLAG -3296 112 Vref
FLAG -576 -752 Vref
FLAG -3600 112 RCC
FLAG -3440 112 RCW
FLAG -3152 -864 0
FLAG -2960 -768 0
FLAG -2560 -976 Filter_OUT
FLAG -2336 -1024 0
FLAG -2096 -1232 Peak_ADJ
FLAG -2048 -864 0
FLAG -1968 -1072 0
FLAG -3152 -432 0
FLAG -2832 -192 0
FLAG -2656 -192 0
FLAG -3568 -144 0
FLAG -2800 -1040 VCC
FLAG -2848 -448 VCC
FLAG -3360 -320 RADIO_SIGNAL
FLAG -3456 -1024 RADIO_SIGNAL
FLAG -1856 -1104 Peak_OUT
FLAG -1984 -1152 VCC
FLAG -3072 112 VCC
FLAG -1760 -1008 Vcc
FLAG -2928 112 10Vin
FLAG -2928 256 0
FLAG 656 48 w
FLAG -64 640 trig
FLAG -304 576 LVs
FLAG 288 96 LDC2
FLAG 288 48 LDC1
FLAG 96 192 0
FLAG -16 16 LB1
FLAG -16 128 LB2
FLAG -304 -80 10Vin
FLAG -672 80 0
FLAG -512 80 LCW
FLAG 160 640 VCC
FLAG -544 48 VCC
FLAG -288 176 0
FLAG -288 432 0
FLAG -528 288 VCC
FLAG -512 320 LCC
FLAG -592 224 Vref
FLAG -1456 -1072 switch
FLAG -1216 -624 RCC
FLAG -1216 -672 RCW
FLAG -1504 -672 LCW
FLAG -1504 -624 LCC
FLAG -1072 -960 10Vin
FLAG -1104 -864 0
FLAG -1072 -768 VCC
FLAG -2848 -944 0
FLAG -3552 112 LCC
FLAG -3392 112 LCW
FLAG -1712 -240 Vo
FLAG -2064 -304 Vs
FLAG -2080 -224 Vref
FLAG -2416 -480 c
FLAG -2144 -512 VCC
FLAG -1968 -352 Vn
FLAG -2368 -400 0
FLAG -1856 -160 0
FLAG -1904 -496 VDC
FLAG -2112 576 trig
FLAG -2448 48 VCC
FLAG -2048 704 VCC
FLAG -2448 576 enc
FLAG -1120 592 PWM
FLAG -1664 912 0
FLAG -1536 800 0
FLAG -1392 800 0
FLAG -1296 688 0
FLAG -2480 256 0
FLAG -2560 256 0
FLAG -2656 256 0
FLAG -2112 528 0
FLAG -3536 400 DCsupply
FLAG -3536 752 DCgnd
FLAG -3136 592 DC1
FLAG -2992 592 DC2
FLAG -3296 576 B1
FLAG -2832 560 B2
FLAG 512 1328 enc
IOPIN 512 1328 Out
FLAG -176 1424 0
FLAG -64 1424 0
FLAG 32 1008 omega
FLAG -368 1008 emf
FLAG 160 1328 p
FLAG 224 1456 0
FLAG -640 1008 +DC
IOPIN -640 1008 BiDir
FLAG -640 1168 -DC
IOPIN -640 1168 BiDir
FLAG 432 1008 omega
IOPIN 432 1008 BiDir
FLAG -16 1200 0
SYMBOL DC_motor_model 528 -912 R0
SYMATTR InstName X1
SYMBOL voltage -3072 160 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VCC
SYMATTR Value 5
SYMBOL Integral_Compensator -400 -896 R0
SYMATTR InstName X3
SYMBOL motor_driver 112 -912 R0
SYMATTR InstName X4
SYMBOL res 0 -864 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName B2
SYMATTR Value 680
SYMBOL res -112 -944 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName B1
SYMATTR Value 680
SYMBOL cap -672 -960 R0
SYMATTR InstName C1
SYMATTR Value 47µ
SYMBOL speed_sensor 48 -384 R180
SYMATTR InstName X2
SYMBOL Integral_Compensator -400 -656 R0
SYMATTR InstName X5
SYMBOL voltage -3600 160 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName CSwitch
SYMATTR Value 0
SYMBOL voltage -3296 160 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName VrefSwitch
SYMATTR Value 4
SYMBOL voltage -3440 160 R0
SYMATTR InstName V2
SYMATTR Value 5
SYMBOL res -3264 -1040 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 240k
SYMBOL res -3168 -960 R0
SYMATTR InstName R2
SYMATTR Value 56
SYMBOL cap -2928 -1248 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C2
SYMATTR Value 10n
SYMBOL cap -3040 -1040 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL TLV272 -2848 -976 R0
SYMATTR InstName U1
SYMBOL res -2896 -1136 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 1400k
SYMBOL res -2768 -1136 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 50k
SYMBOL res -2976 -864 R0
SYMATTR InstName Rb1
SYMATTR Value 39k
SYMBOL res -2784 -896 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName Ra1
SYMATTR Value 39k
SYMBOL diode -2528 -1216 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMBOL res -2416 -1200 R0
SYMATTR InstName R5
SYMATTR Value 39k
SYMBOL cap -2288 -1184 R0
SYMATTR InstName C4
SYMATTR Value 100n
SYMBOL res -2064 -1024 R0
SYMATTR InstName R6
SYMATTR Value 140k
SYMBOL cap -1984 -992 R0
SYMATTR InstName C5
SYMATTR Value .1µ
SYMBOL res -1792 -1008 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 47k
SYMBOL TLV272 -1968 -1104 R0
SYMATTR InstName U2
SYMBOL LM555 -2992 -352 R0
SYMATTR InstName U3
SYMBOL cap -2848 -256 R0
SYMATTR InstName C6
SYMATTR Value .01µ
SYMBOL res -2672 -432 R0
SYMATTR InstName Rb2
SYMATTR Value 4.29k
SYMBOL cap -2672 -288 R0
SYMATTR InstName C7
SYMATTR Value .1µ
SYMBOL voltage -3568 -240 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName WAVEFORM1
SYMATTR Value PULSE(0 5 1n 1n 1n .01666666 .0333333)
SYMBOL arduinoSymbol -1232 -896 R0
SYMATTR InstName X6
SYMBOL voltage -2928 160 R0
SYMATTR InstName 10Vin
SYMATTR Value 10
SYMBOL DC_motor_model 512 64 R0
SYMATTR InstName X7
SYMBOL Integral_Compensator -416 80 R0
SYMATTR InstName X8
SYMBOL motor_driver 96 64 R0
SYMATTR InstName X9
SYMBOL res -16 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName B3
SYMATTR Value 680
SYMBOL res -128 32 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName B4
SYMATTR Value 680
SYMBOL cap -688 16 R0
SYMATTR InstName C8
SYMATTR Value 47µ
SYMBOL speed_sensor 32 592 R180
SYMATTR InstName X10
SYMBOL Integral_Compensator -416 320 R0
SYMATTR InstName X11
SYMBOL res -2064 -288 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R8
SYMATTR Value 82k
SYMBOL cap -1840 -336 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C9
SYMATTR Value 1µ
SYMBOL res -2384 -496 R0
SYMATTR InstName R9
SYMATTR Value 22k
SYMBOL pmos -2272 -400 M180
SYMATTR InstName M1
SYMATTR Value HAT1072H
SYMBOL TLV272 -1856 -240 R0
SYMATTR InstName U4
SYMBOL cap -2272 560 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C10
SYMATTR Value 100p
SYMBOL LM555 -1840 608 R0
SYMATTR InstName U5
SYMBOL res -2208 208 R0
SYMATTR InstName R10
SYMATTR Value 4700
SYMATTR SpiceLine tol=5
SYMBOL diode -1952 288 R180
WINDOW 0 24 64 Left 2
WINDOW 3 64 -12 Top 2
SYMATTR InstName D2
SYMATTR Value 1N4148
SYMBOL polcap -2672 128 R0
WINDOW 3 24 56 Left 2
SYMATTR Value 47µ
SYMATTR InstName C11
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine V=6.3 Irms=2.1 Rser=0.028 Lser=0 mfg="KEMET" pn="A700V476M006ATE028" type="Al electrolytic"
SYMBOL cap -2576 128 R0
SYMATTR InstName C12
SYMATTR Value 1µ
SYMBOL cap -2496 128 R0
SYMATTR InstName C13
SYMATTR Value 1µ
SYMBOL res -1552 256 R0
SYMATTR InstName R11
SYMATTR Value 5600
SYMBOL cap -1552 672 R0
SYMATTR InstName C14
SYMATTR Value .1µ
SYMBOL cap -1680 736 R0
SYMATTR InstName C15
SYMATTR Value 0.1µ
SYMBOL TLC3702 -1296 592 R0
SYMATTR InstName U6
SYMBOL res -1408 400 R0
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL res -1408 640 R0
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res -2384 224 R0
SYMATTR InstName R14
SYMATTR Value 1k
SYMBOL cap -3456 624 R0
SYMATTR InstName C16
SYMATTR Value 47µF
SYMBOL npn -3264 432 R0
SYMATTR InstName Q1
SYMATTR Value FZT849
SYMBOL pnp -2864 720 R180
SYMATTR InstName Q2
SYMATTR Value 2N2905A
SYMBOL npn -2864 432 M0
SYMATTR InstName Q3
SYMATTR Value FZT849
SYMBOL pnp -3264 720 M180
SYMATTR InstName Q4
SYMATTR Value 2N2905A
SYMBOL Digital\\schmtinv 80 1264 R0
WINDOW 3 -86 113 Left 2
WINDOW 0 22 87 Left 2
SYMATTR Value Vt=0.5 Vh=0.5 td=10n
SYMATTR InstName Aenc1
SYMBOL bi -176 1408 R180
WINDOW 0 -55 54 Left 2
WINDOW 3 -329 -61 Left 2
SYMATTR InstName Bp1
SYMATTR Value I=kenc*abs(v(omega))*(V(p)-0.5)
SYMBOL cap -80 1328 R0
WINDOW 0 -44 62 Left 2
WINDOW 3 29 56 Left 2
SYMATTR InstName Cenc1
SYMATTR Value 1m
SYMBOL ind -592 1024 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -9 54 VBottom 2
SYMATTR InstName LM1
SYMATTR Value 65µH
SYMBOL res -496 1024 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -10 52 VBottom 2
SYMATTR InstName RM1
SYMATTR Value {RM}
SYMBOL bv -320 1024 R0
WINDOW 0 12 13 Left 2
WINDOW 3 -93 163 Left 2
SYMATTR InstName Bemf1
SYMATTR Value V=k*V(omega)
SYMBOL bi -176 1120 R180
WINDOW 0 -101 81 Left 2
WINDOW 3 -86 -67 Left 2
SYMATTR InstName Itorque1
SYMATTR Value I=k*I(Bemf)
SYMBOL cap -64 1056 R0
SYMATTR InstName C_Jinertia1
SYMATTR Value {J}
SYMBOL res 80 1040 R0
SYMATTR InstName R_Bfriction1
SYMATTR Value {1/B}
SYMBOL bv 224 1328 R0
WINDOW 0 40 50 Left 2
WINDOW 3 50 94 Left 2
SYMATTR InstName Benc1
SYMATTR Value V=5*V(p)
SYMBOL bi 304 1040 R0
WINDOW 3 -264 153 Left 2
WINDOW 0 24 1 Left 2
SYMATTR Value I=sgn(v(omega))*min(Tint,0.1*abs(v(omega)))
SYMATTR InstName I_load_torque_int1
SYMBOL res 448 1312 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 220
TEXT -1640 -168 Left 2 !.tran .6 startup
TEXT -3344 -216 Left 2 !.tran .2
TEXT -3080 -584 Left 2 ;Transmitter Circuit
TEXT -2808 -1280 Left 2 ;RF reciever
TEXT -1280 -1336 Left 2 ;Arduino Uno
TEXT -3336 -8 Left 2 ;Random simulation tools
TEXT -88 -1152 Left 2 ;Right wheel control
TEXT 224 -120 Left 2 ;Left wheel control
TEXT -2216 -624 Left 2 ;Integral Compensator Internals
TEXT -2000 -32 Left 2 ;Speed Sensor Internals
TEXT -3384 360 Left 2 ;Motor Control Internals
TEXT -120 1504 Left 2 !.param kenc=0.49
TEXT -32 968 Left 2 ;wheel speed [rad/s]
TEXT 432 1376 Left 2 ;Encoder pulses
TEXT 200 1256 Center 2 ;Encoder model
TEXT -632 1312 Left 2 !.param RM = 3.33\n.param k = 0.9395\n.param J = 4.5m\n.param B = 9.7m\n.param Tint = 0.0912
TEXT -520 1248 Center 2 ;Update These Parameters\n(Do not make any other changes)
TEXT -576 920 Left 2 ;Electrical Model
TEXT 88 920 Left 2 ;Mechanical Model
TEXT -176 824 Left 2 ;DC Motor Model
TEXT -296 856 Left 2 ;Courtesy of Dan Seltzer, CU Boulder
RECTANGLE Normal -1664 -688 -3656 -1360 2
RECTANGLE Normal -848 -208 -1648 -1368 2
RECTANGLE Normal -2784 320 -3664 -64 2
RECTANGLE Normal -2496 -80 -3664 -672 2
RECTANGLE Normal 784 -192 -832 -1200 2
RECTANGLE Normal 784 784 -832 -176 2
RECTANGLE Normal -1664 -80 -2480 -672 2
RECTANGLE Normal -976 992 -2768 -64 2
RECTANGLE Normal -2784 832 -3664 336 2
RECTANGLE Normal -320 1456 -736 1216
RECTANGLE Normal -240 1200 -768 944
RECTANGLE Normal 592 1232 -224 944
RECTANGLE Normal 608 1536 -208 1280
RECTANGLE Normal 688 1568 -832 800 2
